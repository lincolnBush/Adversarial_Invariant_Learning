Environment:
	Python: 3.7.9
	PyTorch: 1.7.0
	Torchvision: 0.8.1
	CUDA: 10.2
	CUDNN: 7605
	NumPy: 1.19.2
	PIL: 8.0.1
Args:
	algorithm: AIL
	checkpoint_freq: None
	data_dir: ./datasets
	dataset: ColoredMNIST
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 12
	output_dir: ./outputs_cmnist/642ae9e29a8081123d6eff3a0cc7a4b4
	seed: 2057132098
	skip_model_save: False
	steps: None
	test_envs: [2]
	trial_seed: 1
HParams:
	batch_size: 91
	class_balanced: False
	data_augmentation: False
	irm_lambda: 804.4681906942849
	irm_penalty_anneal_iters: 700
	lr: 0.00013722302722327229
	resnet18: True
	resnet_dropout: 0.1
	vae_lr: 1.5764156688464107e-05
	weight_decay: 0.0
VAE pretrained!
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  epoch         loss          nll           penalty       step          step_time    
0.7526783801  0.7537505358  0.6919697863  0.6840977282  0.2559061445  0.2633947707  0.0000000000  0.0173654947  0.0173579976  0.0000074981  0             0.3366198540 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  0.4874912948  0.0105616405  0.0104228813  0.0001387592  100           0.2639035106 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  0.9749825896  0.0107944299  0.0106643181  0.0001301117  200           0.2727818966 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  1.4624738844  0.0095027689  0.0093782927  0.0001244761  300           0.2645532703 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  1.9499651792  0.0105295946  0.0104024000  0.0001271945  400           0.2853809357 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  2.4374564740  0.0098068455  0.0096973686  0.0001094770  500           0.2834802628 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  2.9249477688  0.0108076912  0.0106799302  0.0001277610  600           0.2619197154 
0.9000964217  0.9024860694  0.8000749987  0.7968281183  0.1004982054  0.1009429919  3.4124390636  0.0102506178  0.0088066119  0.0001144312  700           0.2676388192 
0.5636383115  0.5690098586  0.5711683720  0.5597942563  0.6188996625  0.6108015431  3.8999303584  0.0315916672  0.0151098183  0.0000204879  800           0.2680642033 
0.5374437540  0.5370767252  0.5535436867  0.5428632662  0.6586489527  0.6523789113  4.3874216532  0.0164257280  0.0160243867  0.0000004989  900           0.2901410913 
0.4985001071  0.4933561937  0.5218299673  0.5175739391  0.7016124712  0.6877411059  4.8749129480  0.0167351226  0.0165249854  0.0000002612  1000          0.2908208513 
0.4743946861  0.4712816117  0.5017946108  0.4892841835  0.6833985107  0.6765966567  5.3624042428  0.0167964157  0.0165363929  0.0000003232  1100          0.2659192872 
0.6173666167  0.6189455637  0.6090962661  0.6015859408  0.5920072856  0.5887269610  5.8498955376  0.0163708199  0.0161757289  0.0000002425  1200          0.2622809696 
0.6677737304  0.6740248607  0.6511490866  0.6444492070  0.5339904645  0.5351478783  6.3373868324  0.0158642826  0.0156922724  0.0000002138  1300          0.2648372602 
0.4421469895  0.4309901414  0.4720094284  0.4684954994  0.7178443242  0.7173167595  6.8248781272  0.0163182102  0.0161694797  0.0000001849  1400          0.2814198995 
0.6028497964  0.6082297471  0.6029892323  0.5945135019  0.6238281459  0.6236605229  7.3123694220  0.0167608108  0.0165581280  0.0000002519  1500          0.1239642835 
0.6448467967  0.6465923703  0.6375421867  0.6296613802  0.5793110837  0.5726532362  7.7998607168  0.0161522762  0.0159975244  0.0000001924  1600          0.1213702130 
0.4163274052  0.4091298757  0.4607060588  0.4524217745  0.7782718166  0.7736819546  8.2873520116  0.0160103872  0.0157138728  0.0000003686  1700          0.1227775908 
0.6492929076  0.6603086155  0.6364172068  0.6264466352  0.5829003054  0.5840120017  8.7748433064  0.0168212442  0.0167143067  0.0000001329  1800          0.1222348428 
0.6386329548  0.6463780540  0.6251138373  0.6213030433  0.5805432046  0.5855122160  9.2623346012  0.0164244384  0.0162814344  0.0000001778  1900          0.1216606593 
0.5755838869  0.5722246035  0.5870252317  0.5760822975  0.6479348583  0.6491641663  9.7498258960  0.0160787927  0.0159947672  0.0000001044  2000          0.1209298444 
0.6625776730  0.6650235748  0.6419349654  0.6363051865  0.5697219693  0.5724389198  10.237317190  0.0162735396  0.0162077208  0.0000000818  2100          0.1219417500 
0.6846475252  0.6823831976  0.6492205496  0.6429489927  0.4534204746  0.4560651522  10.724808485  0.0163697556  0.0159603993  0.0000005089  2200          0.1220748091 
0.7412149132  0.7481783112  0.6989339476  0.6952421775  0.4351529437  0.4335619374  11.212299780  0.0163318979  0.0162025924  0.0000001607  2300          0.1220605206 
0.5106599529  0.5008572653  0.5273477259  0.5145735105  0.6710773022  0.6718816974  11.699791075  0.0167599985  0.0166791190  0.0000001005  2400          0.1207967854 
0.5309085065  0.5267895414  0.5444367065  0.5413630519  0.6971125516  0.6954564938  12.187282370  0.0160469076  0.0159685406  0.0000000974  2500          0.1215240836 
0.5696914506  0.5675096442  0.5689184122  0.5565795114  0.6229174479  0.6210887270  12.674773664  0.0164355495  0.0163654432  0.0000000871  2600          0.1217371893 
0.4854831798  0.4815687955  0.5096694702  0.4974282040  0.7060052499  0.7063866267  13.162264959  0.0161406038  0.0160877287  0.0000000657  2700          0.1223650551 
0.6100814228  0.6146592370  0.5949000911  0.5863694814  0.5291691220  0.5330047150  13.649756254  0.0166365995  0.0165774897  0.0000000735  2800          0.1209198046 
0.4069530748  0.4007715388  0.4356886484  0.4367766824  0.6920769272  0.6896699529  14.137247549  0.0158667508  0.0157845254  0.0000001022  2900          0.1219561768 
0.4471823441  0.4522074582  0.4836342208  0.4766395199  0.6967375583  0.6888126875  14.624738843  0.0156319636  0.0154354608  0.0000002443  3000          0.1211880636 
0.7202699807  0.7220317188  0.6868805914  0.6879554222  0.5163122087  0.5135019288  15.112230138  0.0165270822  0.0164386926  0.0000001099  3100          0.1223018503 
0.5537283051  0.5527218174  0.5707933787  0.5555079297  0.6631488723  0.6534504929  15.599721433  0.0161206883  0.0159901442  0.0000001623  3200          0.1224597120 
0.6469359331  0.6538791256  0.6284352065  0.6204457780  0.5118122891  0.5152164595  16.087212728  0.0164494492  0.0163588014  0.0000001127  3300          0.1205827665 
0.4894471823  0.4907843978  0.5085980607  0.5000000000  0.6846306316  0.6813116159  16.574704023  0.0161515381  0.0160847272  0.0000000830  3400          0.1212746620 
0.6245446754  0.6294470639  0.6165961322  0.6120874411  0.6308994482  0.6281611659  17.062195317  0.0168291419  0.0167248247  0.0000001297  3500          0.1205502820 
0.6459181487  0.6480925847  0.6359350726  0.6238748393  0.6190603739  0.6150878697  17.549686612  0.0157923605  0.0156999462  0.0000001149  3600          0.1210636687 
0.6093314763  0.6110158594  0.5979536080  0.5893699100  0.4596346494  0.4627089584  18.037177907  0.0157521088  0.0156651000  0.0000001082  3700          0.1225429654 
0.7219841440  0.7263180454  0.6925590614  0.6851693099  0.5163657792  0.5122160309  18.524669202  0.0165394636  0.0164234171  0.0000001443  3800          0.1216126609 
0.5565673880  0.5514359194  0.5634006536  0.5439348478  0.6625595972  0.6673810544  19.012160497  0.0161879601  0.0161060141  0.0000001019  3900          0.1215088034 
0.6600064281  0.6611658808  0.6404885627  0.6305186455  0.5427224514  0.5507929704  19.499651791  0.0163532680  0.0162841234  0.0000000860  4000          0.1210457253 
0.5872080566  0.5962280326  0.5818824664  0.5728675525  0.5854181175  0.5940848693  19.987143086  0.0163866450  0.0163075265  0.0000000983  4100          0.1213933015 
0.5926719520  0.5960137162  0.5872930841  0.5807972568  0.6268816628  0.6328761252  20.474634381  0.0158014341  0.0157556382  0.0000000569  4200          0.1209127736 
0.4988215127  0.5019288470  0.5284191354  0.5158594085  0.7117372904  0.7141020146  20.962125676  0.0158776496  0.0158323395  0.0000000563  4300          0.1212001014 
0.4139704307  0.4187741106  0.4504740987  0.4414916417  0.7196657203  0.7233176168  21.449616971  0.0163543076  0.0162509320  0.0000001285  4400          0.1223873377 
0.5254446111  0.5240034291  0.5207585579  0.5152164595  0.5142229603  0.5126446635  21.937108265  0.0163225709  0.0162683712  0.0000000674  4500          0.1326600480 
0.5715127491  0.5705100729  0.5554722237  0.5510072868  0.4881341405  0.4903557651  22.424599560  0.0166884532  0.0165137073  0.0000002172  4600          0.1403908753 
0.4872509106  0.4822117445  0.5180800343  0.5070724389  0.7304333851  0.7314616374  22.912090855  0.0159964413  0.0159462744  0.0000000624  4700          0.1416196322 
0.5663702593  0.5604372053  0.5707933787  0.5471495928  0.6505062410  0.6558079726  23.399582150  0.0164506116  0.0163941249  0.0000000702  4800          0.1377193356 
0.6448467967  0.6408058294  0.6351850860  0.6210887270  0.5971500509  0.5960137162  23.887073445  0.0160613255  0.0159928962  0.0000000851  4900          0.2456542158 
0.4666809514  0.4571367338  0.4942947447  0.4817831119  0.7136658274  0.7048864123  24.374564739  0.0159923816  0.0159067963  0.0000001064  5000          0.3541578007 
