Environment:
	Python: 3.7.9
	PyTorch: 1.7.0
	Torchvision: 0.8.1
	CUDA: 10.2
	CUDNN: 7605
	NumPy: 1.19.2
	PIL: 8.0.1
Args:
	algorithm: AIL
	checkpoint_freq: None
	data_dir: ./datasets
	dataset: PSST
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 5
	output_dir: ./outputs_psst_25_2/61c6da481f6ce3efeb1ad4ea1bd92fa0
	seed: 1453902377
	skip_model_save: False
	steps: None
	test_envs: [2]
	trial_seed: 0
HParams:
	batch_size: 145
	class_balanced: False
	data_augmentation: False
	irm_lambda: 94426.4623026721
	irm_penalty_anneal_iters: 132
	lr: 6.0878160019163626e-05
	resnet18: True
	resnet_dropout: 0.0
	vae_lr: 8.861118833909944e-06
	weight_decay: 4.7001370160316345e-05
loading train data from 2 environments
loading test data from 3 environments
187.49655172413793
VAE pretrained!
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  epoch         loss          nll           penalty       step          step_time    
0.5420189692  0.5411764706  0.5530584471  0.5494408476  0.5250000000  0.4915254237  0.0000000000  0.0097900350  0.0097900275  0.0000000068  0             0.1091215611 
0.6096242923  0.6085294118  0.6441313863  0.6349323131  0.4541666667  0.3559322034  0.5333431419  0.0094578113  0.0094569090  0.0000009023  100           0.0862631559 
0.5251084479  0.5285294118  0.5321293265  0.5217775162  0.5291666667  0.4915254237  1.0666862839  0.1546356640  0.0091098634  0.0000031553  200           0.0859723186 
0.5249613999  0.5282352941  0.5318718505  0.5217775162  0.5291666667  0.4915254237  1.6000294258  0.0984229988  0.0092532622  0.0000009443  300           0.0842219687 
0.5249246379  0.5282352941  0.5317247214  0.5216303708  0.5291666667  0.4915254237  2.1333725678  0.0818460073  0.0093727378  0.0000007675  400           0.0878441811 
0.5249246379  0.5282352941  0.5317247214  0.5216303708  0.5291666667  0.4915254237  2.6667157097  0.0551352174  0.0094943080  0.0000004833  500           0.0863676071 
0.5257334020  0.5285294118  0.5332695774  0.5236904061  0.5291666667  0.4915254237  3.2000588517  0.0159804999  0.0094692636  0.0000000690  600           0.0861405706 
0.5040070583  0.5069117647  0.5078162357  0.5032371984  0.4958333333  0.4745762712  3.7334019936  0.0098356352  0.0096112247  0.0000000024  700           0.0883969998 
0.4812513786  0.4938235294  0.4794203112  0.4780753384  0.5041666667  0.4576271186  4.2667451355  0.0097370566  0.0096196942  0.0000000012  800           0.0897680640 
0.4962502757  0.5038235294  0.4991723986  0.4972042378  0.4750000000  0.4576271186  4.8000882775  0.0096829218  0.0095770259  0.0000000011  900           0.0891522479 
0.5098154547  0.5150000000  0.5156140803  0.5100058858  0.4708333333  0.4745762712  5.3334314194  0.0098154196  0.0097178646  0.0000000010  1000          0.0896204519 
0.5078303066  0.5147058824  0.5140324420  0.5083872866  0.4708333333  0.4576271186  5.8667745614  0.0097241410  0.0096245927  0.0000000011  1100          0.1070655346 
0.5129402250  0.5147058824  0.5176738883  0.5092701589  0.4916666667  0.4406779661  6.4001177033  0.0097385420  0.0096548534  0.0000000009  1200          0.1066371274 
0.4945592236  0.5045588235  0.4957884283  0.4952913479  0.4833333333  0.4745762712  6.9334608453  0.0097427679  0.0096580299  0.0000000009  1300          0.1077676058 
0.5090434527  0.5158823529  0.5152830397  0.5111830489  0.4750000000  0.4745762712  7.4668039872  0.0097207096  0.0096303525  0.0000000010  1400          0.1019977784 
0.5087861187  0.5186764706  0.5128921911  0.5122130665  0.4708333333  0.4576271186  8.0001471291  0.0097363339  0.0096619790  0.0000000008  1500          0.1062111449 
0.5060289685  0.5123529412  0.5064552911  0.5086815774  0.4875000000  0.4745762712  8.5334902711  0.0096963472  0.0096306645  0.0000000007  1600          0.1049418211 
0.4698183957  0.4745588235  0.4627579358  0.4593878752  0.4916666667  0.5254237288  9.0668334130  0.0096791705  0.0095921794  0.0000000009  1700          0.1080689836 
0.5152562312  0.5144117647  0.5204693420  0.5142731018  0.4916666667  0.5423728814  9.6001765550  0.0097727922  0.0096916455  0.0000000009  1800          0.1139374971 
0.5230130137  0.5204411765  0.5301430831  0.5244261330  0.4916666667  0.5423728814  10.133519696  0.0096449694  0.0095617419  0.0000000009  1900          0.1083289981 
0.4606278950  0.4698529412  0.4493324015  0.4504120071  0.5041666667  0.5762711864  10.666862838  0.0097851278  0.0096981359  0.0000000009  2000          0.1027415419 
0.4736416440  0.4842647059  0.4656637363  0.4676280165  0.4916666667  0.5593220339  11.200205980  0.0097066972  0.0096356739  0.0000000008  2100          0.1092107630 
0.5139327991  0.5177941176  0.5173060654  0.5138316657  0.5041666667  0.5593220339  11.733549122  0.0097986926  0.0097190114  0.0000000008  2200          0.1101837993 
0.5125358430  0.5201470588  0.5137381837  0.5104473220  0.4625000000  0.4915254237  12.266892264  0.0097189720  0.0096417884  0.0000000008  2300          0.1074473834 
0.4793397544  0.4850000000  0.4704822158  0.4692466157  0.5083333333  0.5593220339  12.800235406  0.0096614109  0.0095877021  0.0000000008  2400          0.1127932429 
0.4794132784  0.4814705882  0.4755581712  0.4758681577  0.5041666667  0.5593220339  13.333578548  0.0095811796  0.0095151384  0.0000000007  2500          0.1133698249 
0.5171310933  0.5211764706  0.5211314231  0.5172160094  0.5125000000  0.5932203390  13.866921690  0.0096470742  0.0095824545  0.0000000007  2600          0.1136668921 
0.5169472833  0.5197058824  0.5216095928  0.5158917010  0.5041666667  0.5932203390  14.400264832  0.0096970337  0.0096354672  0.0000000007  2700          0.1127242422 
0.5294463642  0.5311764706  0.5390076139  0.5354620365  0.4875000000  0.5762711864  14.933607974  0.0097126794  0.0096428512  0.0000000007  2800          0.1115435791 
0.4770605103  0.4785294118  0.4704454335  0.4745438493  0.5000000000  0.5423728814  15.466951116  0.0097453883  0.0096806250  0.0000000007  2900          0.1130212283 
0.4793765164  0.4807352941  0.4683856255  0.4652736904  0.5250000000  0.6271186441  16.000294258  0.0097126861  0.0096412747  0.0000000008  3000          0.1137232232 
0.4515476803  0.4545588235  0.4355390444  0.4371689229  0.5458333333  0.6440677966  16.533637400  0.0096150143  0.0095516558  0.0000000007  3100          0.1139847875 
0.4995956180  0.5030882353  0.4929561923  0.4919070041  0.5041666667  0.6101694915  17.066980542  0.0096884672  0.0096260360  0.0000000007  3200          0.1151668715 
0.5289684582  0.5242647059  0.5381984036  0.5298705121  0.5000000000  0.5762711864  17.600323684  0.0096384826  0.0095769430  0.0000000007  3300          0.1111815929 
0.5113594589  0.5114705882  0.5152462574  0.5100058858  0.5083333333  0.6610169492  18.133666826  0.0097507953  0.0097050730  0.0000000005  3400          0.1100786519 
0.5224248217  0.5242647059  0.5242579174  0.5245732784  0.4666666667  0.5762711864  18.667009968  0.0097109951  0.0096622657  0.0000000005  3500          0.1139623451 
0.5333063745  0.5302941176  0.5408467282  0.5323719835  0.5250000000  0.5932203390  19.200353109  0.0097098420  0.0096458139  0.0000000007  3600          0.1123873234 
0.5247040659  0.5279411765  0.5309522934  0.5295762213  0.5000000000  0.5762711864  19.733696251  0.0096810138  0.0096386780  0.0000000004  3700          0.1128769565 
0.4493787222  0.4501470588  0.4305734358  0.4329017069  0.5291666667  0.6101694915  20.267039393  0.0096838300  0.0096333384  0.0000000005  3800          0.1117167878 
0.5368722888  0.5360294118  0.5462537242  0.5397292525  0.4791666667  0.5254237288  20.800382535  0.0097520070  0.0096974150  0.0000000006  3900          0.1090869379 
0.4577236968  0.4552941176  0.4365689484  0.4451147734  0.5291666667  0.6440677966  21.333725677  0.0096343125  0.0095786877  0.0000000006  4000          0.1041389775 
0.4705903978  0.4720588235  0.4552543495  0.4557092407  0.5291666667  0.6271186441  21.867068819  0.0097219256  0.0096723879  0.0000000005  4100          0.1077584934 
0.5388941990  0.5342647059  0.5484606613  0.5367863449  0.5250000000  0.5084745763  22.400411961  0.0096253977  0.0095661996  0.0000000006  4200          0.1067484021 
0.5439305933  0.5391176471  0.5490491779  0.5467922307  0.4666666667  0.5762711864  22.933755103  0.0097468191  0.0096883874  0.0000000006  4300          0.1137843537 
0.4785309904  0.4695588235  0.4650752198  0.4642436727  0.5166666667  0.6440677966  23.467098245  0.0096273096  0.0095779011  0.0000000005  4400          0.1129179144 
0.5313212264  0.5251470588  0.5366903299  0.5359034726  0.4541666667  0.5423728814  24.000441387  0.0097302486  0.0096789893  0.0000000005  4500          0.1076458192 
0.4711050658  0.4751470588  0.4633832346  0.4683637434  0.4958333333  0.5593220339  24.533784529  0.0096385987  0.0095956564  0.0000000005  4600          0.1213247800 
0.4618778031  0.4560294118  0.4467208592  0.4451147734  0.5500000000  0.6949152542  25.067127671  0.0096842075  0.0096271354  0.0000000006  4700          0.1073085809 
0.4737151680  0.4670588235  0.4608084746  0.4614479105  0.5416666667  0.6440677966  25.600470813  0.0096730016  0.0096281412  0.0000000005  4800          0.1027857637 
0.4827586207  0.4805882353  0.4764041638  0.4891112419  0.4541666667  0.5423728814  26.133813955  0.0096865435  0.0096471275  0.0000000004  4900          0.1071410680 
0.4335710610  0.4333823529  0.4041269725  0.4080341377  0.5791666667  0.6779661017  26.667157097  0.0096198113  0.0095805442  0.0000000004  5000          0.1045685601 
